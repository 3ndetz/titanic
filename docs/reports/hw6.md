
# ДЗ 6: Документация и отчеты

---------------------------

## Задача

* **Баллы:** 8 баллов  

* **Срок сдачи:** 26 декабря

### Описание

Создайте полную документацию проекта и систему генерации отчетов.

### Требования

1. **Техническая документация (2 балла):**
    * Создать документацию с помощью Sphinx или MkDocs
    * Создать руководство по развертыванию
    * Настроить автоматическую генерацию документации
    * Создать примеры использования
2. **Публикация в Git Pages (3 балла):**
    * Настроить GitHub Actions для автоматической публикации
    * Создать сайт с документацией на Git Pages
    * Настроить автоматическое обновление при изменениях
3. **Отчеты об экспериментах (2 балла):**
    * Создать отчеты об экспериментах в формате Markdown
    * Добавить графики и визуализации результатов
    * Создать сравнительные таблицы экспериментов
    * Настроить автоматическую генерацию отчетов
4. **Воспроизводимость (1 балл):**
    * Создать инструкции по воспроизведению
    * Создать README с полным описанием
    * Настроить автоматическую сборку документации

### Критерии оценки

* **Отлично (8 баллов):** Полная документация, качественные отчеты
* **Хорошо (6-7 баллов):** Хорошая документация, базовые отчеты
* **Удовлетворительно (4-5 баллов):** Базовая документация
* **Неудовлетворительно (0-3 балла):** Требования не выполнены

**⚠️ ВАЖНО:** Менторы будут воспроизводить ваши результаты, поэтому постарайтесь все автоматизировать. Если что-то не совпадет при воспроизведении, можно потерять баллы.

## Ход работы

Рассмотрим выполнение каждого из пунктов задания.

1. **Техническая документация (2 балла):**
    * Создать документацию с помощью Sphinx или MkDocs
      * Есть на MkDocs (базово)
    * Создать руководство по развертыванию
      * Есть (базово)
    * Настроить автоматическую генерацию документации
      * По сути создаётся из Markdown файлов автоматически, можно разве что подтянуть структуру кода
    * Создать примеры использования
      * Есть (базово)
2. **Публикация в Git Pages (3 балла):**
    * Настроить GitHub Actions для автоматической публикации
      * Делается через `cd docs`, `mkdocs gh-deploy`
    * Создать сайт с документацией на Git Pages
      * Есть <https://3ndetz.github.io/titanic>
    * Настроить автоматическое обновление при изменениях
      * Можно настроить через ci-cd и вставить в workflow github actions
3. **Отчеты об экспериментах (2 балла):**
    * В целом не готово.
      * Создать отчеты об экспериментах в формате Markdown
      * Добавить графики и визуализации результатов
        * Есть из dvc в VSC и в clearml, но можно сделать сразу отбивку в доки
      * Создать сравнительные таблицы экспериментов
      * Настроить автоматическую генерацию отчетов
        * В целом, видимо, этим и будем заниматься
4. **Воспроизводимость (1 балл):**
    * Создать инструкции по воспроизведению
      * есть
    * Создать README с полным описанием
      * Есть
    * Настроить автоматическую сборку документации
      * Есть, mkdocs gh-deploy уже работает

### Github Actions mkdocs deploy

Приступаем к выполнению. Начнём с gh actions. Потом сделаем пример авто-отчёта по эксперименту.

Добавил CI по [примеру](https://github.com/marketplace/actions/mkdocs-action), настроил его под наш репо. Закоммитил.

Пошли коммиты, пошли actions:

![alt text](images/hw6/image.png)

![alt text](images/hw6/image-1.png)

Внесённое изменение сразу отобразилось:

![alt text](images/hw6/image-2.png)

Отлично, всё работает! Идём дальше.

### Code API Reference Auto-gen

Добавил плагин mkdocstrings-python в mkdocs.yml и поставил зависимость в pyproject.toml. Добавил docs/docs/api/index.md для автогенерации референсов на основе докстрингов в коде.

![alt text](images/hw6/image-3.png)

### AutoReportGen

Теперь сделаем авто-отчёт по экспериментам в markdown.
Добавлять результаты в доку НЕ будем т.к. экспериментов может быть множество, а дока точно не для такого, несмотря на поддержку markdown. Вместо этого будем кидать репорты в какую-нибудь git-ignorную директорию, а в доку возможно будут закидываться только примеры удачных экспериментов.

Добавил dvclive за его возможность легко делать markdownы. Суём его в train там же, где и clearml.
Добавляем для графиков plots в dvc.yaml.

Теперь при запуске экспериментов у нас в dvclive/ будет появляться md-отчёт. Для сравнительных таблиц эксприментов будем юзать `dvc exp show --md > experiments_table.md`.

Проверим, запустим пару экспериментов через dvc exp run train --name ...

Так как только 1 степ логируется (т.к. мы используем fit в обучении, для простоты и унификации пайплайнов), на графиках показывается только 1 точка.

![alt text](images/hw6/image-4.png)

Также в dvclive появляется report.md:

![alt text](images/hw6/image-5.png)

Там с графиками то же самое.

Для наглядности добавим в train confusion matrix, чтобы был хоть 1 график.
